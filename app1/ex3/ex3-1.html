<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>JRostand stade reperes</title>
    <link rel="stylesheet" type="text/css" href="./style.css" />
    <style>
        #map {
            width: 100%;
            height: 500px;
        }
    </style>
</head>

<body>

    <h1>JRostand Reperes Stade</h1>
    <hr>
    <div id="map"></div>

    <script
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA7Y32T_PJHZxYcK3BJYJFNwSl6cuvLXpo&callback=loadDoc&v=weekly" defer></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
        var markers; 
        var map;     

        function loadDoc() {
            map = new google.maps.Map(document.getElementById("map"), {
                center: { lat: 48.9593, lng: 2.5477 },
                zoom: 15,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            });

            $.ajax({
                url: "markersJrostand.json",   // TODO1 
                method: "GET",                 // TODO2 
                dataType: "json",              // TODO3 
                success: function(dataMarkers) { 
                    markers = dataMarkers;

                    
                    for (let i = 0; i < markers.length; i++) {
                        let markerData = markers[i];
                        for (let key in markerData) {
                            console.log(key + ": " + markerData[key]);
                        }
                        console.log("-------------");
                    }

                    // Créer les markers Google Maps
                    for (let i = 0; i < markers.length; i++) {
                        let latlng = markers[i];
                        let marker = new google.maps.Marker({
                            position: latlng,
                            map: map,
                            title: "Marker " + (i + 1)
                        });

                        // Ajouter une alerte personnalisée au clic sur chaque marker
                        google.maps.event.addListener(marker, 'click', function () {
                            alert("Vous avez cliqué sur le marker #" + (i + 1) +
                                  "\nLatitude: " + latlng.lat +
                                  "\nLongitude: " + latlng.lng);
                        });
                    }
                },
                error: function(err) {
                    console.error("Erreur lors du chargement des markers :", err);
                }
            });
        }
    </script>

</body>

</html>
